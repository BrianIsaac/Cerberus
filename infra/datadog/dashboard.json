{
  "title": "AI Agent Fleet Health",
  "description": "Unified health dashboard for all AI agents. Use service filter to drill down to specific agents. All agents are tagged with team:ai-agents for fleet-wide visibility.",
  "widgets": [
    {
      "id": 100,
      "definition": {
        "type": "group",
        "title": "Fleet Overview",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 101,
            "definition": {
              "type": "query_value",
              "title": "Total Agents Active",
              "requests": [
                {
                  "q": "count_not_null(sum:trace.http.request.hits{team:ai-agents,$env} by {service})",
                  "aggregator": "last"
                }
              ]
            }
          },
          {
            "id": 102,
            "definition": {
              "type": "toplist",
              "title": "Request Volume by Agent",
              "requests": [
                {
                  "q": "sum:trace.http.request.hits{team:ai-agents,$env} by {service}.as_count()",
                  "style": {
                    "palette": "dog_classic"
                  }
                }
              ]
            }
          },
          {
            "id": 103,
            "definition": {
              "type": "toplist",
              "title": "Error Rate by Agent (%)",
              "requests": [
                {
                  "q": "sum:trace.http.request.errors{team:ai-agents,$env} by {service}.as_count() / sum:trace.http.request.hits{team:ai-agents,$env} by {service}.as_count() * 100",
                  "style": {
                    "palette": "warm"
                  }
                }
              ]
            }
          },
          {
            "id": 104,
            "definition": {
              "type": "toplist",
              "title": "P95 Latency by Agent (s)",
              "requests": [
                {
                  "q": "p95:trace.http.request.duration{team:ai-agents,$env} by {service}",
                  "style": {
                    "palette": "cool"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": 0,
      "definition": {
        "type": "group",
        "title": "Application Health",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1,
            "definition": {
              "type": "timeseries",
              "title": "Request Volume",
              "requests": [
                {
                  "q": "sum:trace.http.request.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "dog_classic"
                  }
                }
              ]
            }
          },
          {
            "id": 2,
            "definition": {
              "type": "timeseries",
              "title": "P95 Request Latency",
              "requests": [
                {
                  "q": "p95:trace.http.request.duration{$service,$env}",
                  "display_type": "line"
                }
              ],
              "markers": [
                {
                  "value": "y = 10",
                  "display_type": "error dashed",
                  "label": "SLO Threshold (10s)"
                }
              ]
            }
          },
          {
            "id": 3,
            "definition": {
              "type": "query_value",
              "title": "Error Rate (%)",
              "requests": [
                {
                  "q": "sum:trace.http.request.errors{$service,$env}.as_count() / sum:trace.http.request.hits{$service,$env}.as_count() * 100",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 1,
                      "palette": "white_on_red"
                    },
                    {
                      "comparator": "<=",
                      "value": 1,
                      "palette": "white_on_green"
                    }
                  ]
                }
              ]
            }
          },
          {
            "id": 4,
            "definition": {
              "type": "timeseries",
              "title": "Gemini LLM Latency (P95)",
              "requests": [
                {
                  "q": "p95:trace.google_genai.request{$service,$env}",
                  "display_type": "line"
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": 10,
      "definition": {
        "type": "group",
        "title": "Governance & Autonomy",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 11,
            "definition": {
              "type": "timeseries",
              "title": "Gemini LLM Calls Over Time",
              "requests": [
                {
                  "q": "sum:trace.google_genai.request.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "dog_classic"
                  }
                }
              ]
            }
          },
          {
            "id": 12,
            "definition": {
              "type": "timeseries",
              "title": "LangGraph Workflow Calls",
              "requests": [
                {
                  "q": "sum:trace.langgraph.request.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "cool"
                  }
                }
              ]
            }
          },
          {
            "id": 13,
            "definition": {
              "type": "timeseries",
              "title": "Gemini LLM Latency (avg vs P95)",
              "requests": [
                {
                  "q": "avg:trace.google_genai.request{$service,$env}",
                  "display_type": "line"
                },
                {
                  "q": "p95:trace.google_genai.request{$service,$env}",
                  "display_type": "line"
                }
              ]
            }
          },
          {
            "id": 14,
            "definition": {
              "type": "timeseries",
              "title": "LangGraph Errors",
              "requests": [
                {
                  "q": "sum:trace.langgraph.request.errors{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "warm"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": 20,
      "definition": {
        "type": "group",
        "title": "MCP Tools Performance",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 21,
            "definition": {
              "type": "timeseries",
              "title": "MCP Tool Invocations",
              "requests": [
                {
                  "q": "sum:trace.mcp.request.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "dog_classic"
                  }
                }
              ]
            }
          },
          {
            "id": 22,
            "definition": {
              "type": "timeseries",
              "title": "MCP Tool Latency (avg vs P95)",
              "requests": [
                {
                  "q": "avg:trace.mcp.request{$service,$env}",
                  "display_type": "line"
                },
                {
                  "q": "p95:trace.mcp.request{$service,$env}",
                  "display_type": "line"
                }
              ]
            }
          },
          {
            "id": 23,
            "definition": {
              "type": "query_value",
              "title": "MCP Error Rate (%)",
              "requests": [
                {
                  "q": "sum:trace.mcp.request.errors{$service,$env}.as_count() / sum:trace.mcp.request.hits{$service,$env}.as_count() * 100",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 10,
                      "palette": "white_on_red"
                    },
                    {
                      "comparator": "<=",
                      "value": 10,
                      "palette": "white_on_yellow"
                    },
                    {
                      "comparator": "<=",
                      "value": 1,
                      "palette": "white_on_green"
                    }
                  ]
                }
              ]
            }
          },
          {
            "id": 24,
            "definition": {
              "type": "query_value",
              "title": "MCP Apdex Score",
              "requests": [
                {
                  "q": "avg:trace.mcp.request.apdex{$service,$env}",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 0.9,
                      "palette": "white_on_green"
                    },
                    {
                      "comparator": "<=",
                      "value": 0.9,
                      "palette": "white_on_yellow"
                    },
                    {
                      "comparator": "<=",
                      "value": 0.7,
                      "palette": "white_on_red"
                    }
                  ]
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": 30,
      "definition": {
        "type": "group",
        "title": "Quality Evaluations",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 31,
            "definition": {
              "type": "timeseries",
              "title": "RAGAS Faithfulness Score",
              "requests": [
                {
                  "q": "avg:ops_assistant.agent.quality.ragas_faithfulness{$env}",
                  "display_type": "line"
                }
              ],
              "markers": [
                {
                  "value": "y = 0.7",
                  "display_type": "error dashed",
                  "label": "Minimum Acceptable"
                }
              ]
            }
          },
          {
            "id": 32,
            "definition": {
              "type": "timeseries",
              "title": "RAGAS Answer Relevancy Score",
              "requests": [
                {
                  "q": "avg:ops_assistant.agent.quality.ragas_answer_relevancy{$env}",
                  "display_type": "line"
                }
              ],
              "markers": [
                {
                  "value": "y = 0.7",
                  "display_type": "error dashed",
                  "label": "Minimum Acceptable"
                }
              ]
            }
          },
          {
            "id": 33,
            "definition": {
              "type": "timeseries",
              "title": "RAGAS Evaluation Calls",
              "requests": [
                {
                  "q": "sum:trace.dd_ragas.faithfulness.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "dog_classic"
                  }
                }
              ]
            }
          },
          {
            "id": 34,
            "definition": {
              "type": "timeseries",
              "title": "Intake Confidence Score",
              "requests": [
                {
                  "q": "avg:ops_assistant.agent.quality.intake_confidence{$env}",
                  "display_type": "line"
                }
              ],
              "markers": [
                {
                  "value": "y = 0.7",
                  "display_type": "warning dashed",
                  "label": "Confidence Threshold"
                }
              ]
            }
          },
          {
            "id": 35,
            "definition": {
              "type": "timeseries",
              "title": "Synthesis Confidence Score",
              "requests": [
                {
                  "q": "avg:ops_assistant.agent.quality.synthesis_confidence{$env}",
                  "display_type": "line"
                }
              ],
              "markers": [
                {
                  "value": "y = 0.7",
                  "display_type": "warning dashed",
                  "label": "Confidence Threshold"
                }
              ]
            }
          },
          {
            "id": 36,
            "definition": {
              "type": "timeseries",
              "title": "OpenAI Evaluation API Calls",
              "requests": [
                {
                  "q": "sum:trace.openai.request.hits{$service,$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "cool"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "id": 50,
      "definition": {
        "type": "group",
        "title": "Operations & Actionable Items",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 51,
            "definition": {
              "type": "manage_status",
              "title": "Monitor Status Panel",
              "summary_type": "monitors",
              "display_format": "countsAndList",
              "query": "$service"
            }
          },
          {
            "id": 52,
            "definition": {
              "type": "event_stream",
              "title": "Active Incidents & Cases",
              "query": "sources:incident,case $service",
              "event_size": "s"
            }
          },
          {
            "id": 53,
            "definition": {
              "type": "trace_service",
              "title": "Worst Traces (Highest Latency)",
              "service": "",
              "span_name": "http.request",
              "env": "$env",
              "display_format": "three_column",
              "show_breakdown": true,
              "show_distribution": true,
              "show_errors": true,
              "show_hits": true,
              "show_latency": true,
              "show_resource_list": true,
              "size_format": "large"
            }
          }
        ]
      }
    },
    {
      "id": 60,
      "definition": {
        "type": "group",
        "title": "SAS Generator Metrics",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 63,
            "definition": {
              "type": "query_value",
              "title": "Positive Feedback Rate (%)",
              "requests": [
                {
                  "q": "sum:sas_generator.feedback.positive{$env}.as_count() / (sum:sas_generator.feedback.positive{$env}.as_count() + sum:sas_generator.feedback.negative{$env}.as_count()) * 100",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 80,
                      "palette": "white_on_green"
                    },
                    {
                      "comparator": "<=",
                      "value": 80,
                      "palette": "white_on_yellow"
                    },
                    {
                      "comparator": "<=",
                      "value": 50,
                      "palette": "white_on_red"
                    }
                  ]
                }
              ],
              "precision": 1
            }
          },
          {
            "id": 64,
            "definition": {
              "type": "query_value",
              "title": "Query Error Rate (%)",
              "requests": [
                {
                  "q": "sum:sas_generator.queries.error{$env}.as_count() / (sum:sas_generator.queries.success{$env}.as_count() + sum:sas_generator.queries.error{$env}.as_count()) * 100",
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "value": 5,
                      "palette": "white_on_red"
                    },
                    {
                      "comparator": "<=",
                      "value": 5,
                      "palette": "white_on_green"
                    }
                  ]
                }
              ],
              "precision": 1
            }
          },
          {
            "id": 65,
            "definition": {
              "type": "timeseries",
              "title": "Feedback Trend",
              "requests": [
                {
                  "q": "sum:sas_generator.feedback.positive{$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "green"
                  }
                },
                {
                  "q": "sum:sas_generator.feedback.negative{$env}.as_count()",
                  "display_type": "bars",
                  "style": {
                    "palette": "red"
                  }
                }
              ]
            }
          }
        ]
      }
    }
  ],
  "layout_type": "ordered",
  "template_variables": [
    {
      "name": "env",
      "default": "*",
      "prefix": "env",
      "available_values": ["production", "staging", "development"]
    },
    {
      "name": "service",
      "default": "*",
      "prefix": "service",
      "available_values": [
        "ops-assistant",
        "sas-generator"
      ]
    },
    {
      "name": "team",
      "default": "ai-agents",
      "prefix": "team",
      "available_values": ["ai-agents"]
    },
    {
      "name": "ml_app",
      "default": "*",
      "prefix": "ml_app",
      "available_values": [
        "ops-assistant",
        "sas-generator"
      ]
    }
  ]
}
